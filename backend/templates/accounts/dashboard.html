{% extends "base.html" %}
{% block title %}
  {% if profile and profile.is_admin %}
    Кабинет администратора · Союзлифт Аудит
  {% elif profile and profile.is_auditor %}
    Кабинет аудитора · Союзлифт Аудит
  {% else %}
    Личный кабинет · Союзлифт Аудит
  {% endif %}
{% endblock %}
{% block heading %}
  {% if profile and profile.is_admin %}
    Кабинет администратора
  {% elif profile and profile.is_auditor %}
    Кабинет аудитора
  {% else %}
    Личный кабинет
  {% endif %}
{% endblock %}
{% block subheading %}
  {% if profile and profile.is_admin %}
    <p class="mb-0">Управляйте справочниками, чек-листами и аудиторскими проверками без обращения к Django Admin.</p>
  {% elif profile and profile.is_auditor %}
    <p class="mb-0">Следите за статусами назначенных проверок и обновляйте карточки объектов прямо из веб-интерфейса.</p>
  {% else %}
    <p class="mb-0">Добро пожаловать в систему Союзлифт Аудит.</p>
  {% endif %}
{% endblock %}
{% block content %}
  <div class="d-flex flex-column gap-4">
    <div class="row g-3">
      <div class="col-md-6">
        <div class="card shadow-sm h-100">
          <div class="card-body">
            <h2 class="h6 text-uppercase text-muted mb-2">Роль</h2>
            <p class="fs-5 mb-0">
              {% if profile %}
                {% if profile.is_admin %}Администратор{% elif profile.is_auditor %}Аудитор{% else %}Пользователь{% endif %}
              {% else %}
                Пользователь
              {% endif %}
            </p>
          </div>
        </div>
      </div>
      <div class="col-md-6">
        <div class="card shadow-sm h-100">
          <div class="card-body">
            <h2 class="h6 text-uppercase text-muted mb-2">Последняя смена пароля</h2>
            <p class="fs-5 mb-0">
              {% if profile and profile.password_changed_at %}
                {{ profile.password_changed_at|date:"d.m.Y H:i" }}
              {% else %}
                Не задано
              {% endif %}
            </p>
          </div>
        </div>
      </div>
    </div>

    {% if profile and profile.is_admin %}
      <div class="card shadow-sm">
        <div class="card-body d-flex flex-column gap-3">
          <p class="mb-0 text-body-secondary">
            Используйте разделы ниже для модерации объектов, управления чек-листами и контроля отправленных аудитов. Для операций
            с пользователями обращайтесь к техническому оператору или используйте Django Admin при наличии прав суперпользователя.
          </p>
          <div class="row g-3">
            <div class="col-sm-6 col-lg-3">
              <a href="{% url 'catalog:building-list' %}" class="btn btn-outline-primary w-100">Здания</a>
              <p class="small text-body-secondary mt-2 mb-0">Модерируйте новые адреса и актуализируйте сведения об объектах.</p>
            </div>
            <div class="col-sm-6 col-lg-3">
              <a href="{% url 'catalog:elevator-list' %}" class="btn btn-outline-primary w-100">Лифты</a>
              <p class="small text-body-secondary mt-2 mb-0">Проверяйте карточки оборудования и подтверждайте изменения.</p>
            </div>
            <div class="col-sm-6 col-lg-3">
              <a href="{% url 'checklists:template-list' %}" class="btn btn-outline-primary w-100">Чек-листы</a>
              <p class="small text-body-secondary mt-2 mb-0">Публикуйте версии шаблонов и управляйте обязательными пунктами.</p>
            </div>
            <div class="col-sm-6 col-lg-3">
              <a href="{% url 'audits:audit-list' %}" class="btn btn-outline-primary w-100">Аудиты</a>
              <p class="small text-body-secondary mt-2 mb-0">Отслеживайте отправленные отчёты и возвращайте их на доработку.</p>
            </div>
          </div>
          <div class="alert alert-info mb-0" role="note">
            При необходимости вмешательства в данные вне пользовательского интерфейса обратитесь к техническому оператору.
          </div>
        </div>
      </div>
    {% elif profile and profile.is_auditor %}
      <div class="card shadow-sm">
        <div class="card-body d-flex flex-column gap-3">
          <p class="mb-0 text-body-secondary">
            Рабочая область объединяет назначенные аудиты и справочники. Новые записи проходят модерацию администратора перед тем,
            как стать доступными остальным пользователям.
          </p>
          <div class="row g-3">
            <div class="col-sm-6 col-lg-4">
              <a href="{% url 'audits:audit-list' %}" class="btn btn-outline-primary w-100">Мои аудиты</a>
              <p class="small text-body-secondary mt-2 mb-0">Заполняйте ответы, сохраняйте черновики и отправляйте результаты.</p>
            </div>
            <div class="col-sm-6 col-lg-4">
              <a href="{% url 'catalog:building-list' %}" class="btn btn-outline-primary w-100">Здания</a>
              <p class="small text-body-secondary mt-2 mb-0">Проверяйте адреса объектов и добавляйте новые с последующей модерацией.</p>
            </div>
            <div class="col-sm-6 col-lg-4">
              <a href="{% url 'catalog:elevator-list' %}" class="btn btn-outline-primary w-100">Лифты</a>
              <p class="small text-body-secondary mt-2 mb-0">Актуализируйте сведения о лифтах и отслеживайте статус записи.</p>
            </div>
          </div>
          <div class="alert alert-info mb-0" role="note">
            Все необходимые действия доступны в пользовательском интерфейсе. При технических вопросах обратитесь к администратору.
          </div>
        </div>
      </div>
    {% else %}
      <div class="alert alert-warning mb-0" role="alert">
        Профиль пользователя не настроен. Обратитесь к администратору системы, чтобы назначить роль и получить доступ к рабочим разделам.
      </div>
    {% endif %}
  </div>
{% endblock %}
