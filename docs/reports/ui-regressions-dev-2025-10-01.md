# DEV UI regression test — 2025-10-01

## Резюме проверки (T13.3)

| ID | Критичность | Статус | Краткое описание | Скриншоты | Страницы |
| --- | --- | --- | --- | --- | --- |
| UI-REG-010 | Средняя | Подтверждено исправно | Базовый макет (`base.html`): отступы контейнера, фоновые слои и хедер соответствуют токенам дизайн-системы. | локально: `ui-reg-010.png` (не выгружен) | `accounts:dashboard`, `audits:audit-list`, `catalog:building-list`, `catalog:elevator-list` |
| UI-REG-011 | Средняя | Подтверждено исправно | Кнопки (`.btn--primary`, `.btn--secondary`, `.btn--ghost`, `.btn--danger`) и состояния фокуса соответствуют конфигурации Tailwind. | локально: `ui-reg-011.png` (не выгружен) | `accounts:login`, `audits:audit-list`, модальные окна офлайн-портала |
| UI-REG-012 | Средняя | Подтверждено исправно | Компоненты уведомлений (`.app-alert--*`) и карточки (`.app-card`) отображаются с корректными цветами и тенями. | локально: `ui-reg-012.png` (не выгружен) | Flash-сообщения Django, панель синхронизации офлайн-портала |
| UI-REG-013 | Высокая | Подтверждено исправно | Офлайн-форма чек-листа: сохранение полей, валидация обязательных комментариев, индикаторы загрузки. | локально: `ui-reg-013.png` (не выгружен) | `audits:offline_object_info`, `audits:offline_checklist` |
| UI-REG-014 | Средняя | Подтверждено исправно | Печатный экспорт `audits:export_print` использует актуальные цвета/типографику и не ломает разметку при `@media print`. | локально: `ui-reg-014.png` (не выгружен) | `audits:export_print` |

**Итог:** критических и высоких регрессий не выявлено. Все проверенные элементы соответствуют обновлённой дизайн-системе (см. [§4.1](../architecture/v1.md#41-%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D1%82%D0%B5%D0%BB%D1%8C%D1%81%D0%BA%D0%B8%D0%B9-%D1%81%D0%BB%D0%BE%D0%B9) и [§10](../architecture/v1.md#10-%D1%82%D0%B5%D1%81%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5-%D0%B8-%D0%BA%D0%BE%D0%BD%D1%82%D1%80%D0%BE%D0%BB%D1%8C-%D0%BA%D0%B0%D1%87%D0%B5%D1%81%D1%82%D0%B2%D0%B0)).

## Методология

1. Пересобран Tailwind CSS согласно инструкции в `tailwind.config.js` (использовалась CLI `npx tailwindcss ...`). Полученный файл `backend/static/css/tailwind.min.css` проверен на наличие обновлённых переменных цветов и компонентов (`app-card`, `app-header`, `btn*`, `app-alert`).
2. Локально запущен DEV-сервер: `python backend/manage.py runserver` (Chrome 117, разрешение 1440×900). Просмотрены основные страницы аудиторского портала и офлайн-формы.
3. Проверены интерактивные состояния (hover/focus) через DevTools, в том числе псевдоклассы `:focus-visible`, вариации `aria-current`, `aria-expanded` и кастомные состояния `data-state`.
4. Проверено отсутствие ошибок в консоли браузера и корректная регистрация сервис-воркера (`service-worker.js` загружается, регистрация не падает).
5. Для офлайн-форм исполнены smoke-скрипты из офлайн-портала: создание черновика, заполнение обязательных полей, имитация отправки с отключённой сетью (DevTools → Offline). Очередь синхронизации отображает статусы без визуальных артефактов.
6. Печатный макет `audits:export_print` протестирован через `Ctrl+P` → «Сохранить как PDF» (без сохранения файла) и просмотр `@media print` в DevTools: проверены размеры шрифтов, отсутствие усечённых границ и корректный фон таблиц.

## Детализация кейсов

### UI-REG-010 — Базовый макет после обновления дизайн-системы
- **Фактическое состояние:** контейнер использует ширины, указанные в `tailwind.config.js` (`xl: 1240px`, `2xl: 1360px`); padding на брейкпоинтах соответствует ожиданиям.
- **Проверенные элементы:** хедер (`.app-header`), заголовки (`font-heading`), футер, фон `bg-surface`.
- **Итог:** визуальные дефекты не выявлены, контент центрирован.

### UI-REG-011 — Кнопки и состояния фокуса
- **Фактическое состояние:** классы `.btn--primary`, `.btn--secondary`, `.btn--ghost`, `.btn--danger` наследуют базовый `.btn` с корректными тенями (`shadow-soft`) и обводками `focus-visible`.
- **Дополнительно:** проверена совместимость с кнопками вне компонентной системы (например, фильтры `audits:audit-list`, `catalog`), где используются прямые утилитные классы — конфликтов не обнаружено.
- **Итог:** цветовая палитра соответствует переменным `--color-brand-*`, `--color-danger-*`.

### UI-REG-012 — Уведомления и карточки
- **Фактическое состояние:** `messages` из Django отображаются с классами `app-alert--*`, фоновые цвета и границы соответствуют HSL-переменным из `tailwind.src.css`.
- **Дополнительно:** карточки `.app-card` сохраняют скругления `rounded-2xl` и тень `shadow-card`, перекрытий содержимого не обнаружено.
- **Итог:** визуальные слои согласованы между светлым фоном и поднятыми карточками.

### UI-REG-013 — Офлайн-форма чек-листа
- **Фактическое состояние:** при отключении сети DevTools элементы `data-portal-*` продолжают работать, обязательные комментарии подсвечиваются `text-danger-600`, фокус на полях сохраняет подсказки.
- **Дополнительно:** проверен счётчик вложений (до лимита 10 на вопрос) — предупреждения визуализируются в соответствии с дизайн-токенами.
- **Итог:** UX офлайн-режима соответствует описанию [§6 архитектуры](../architecture/v1.md#6-%D0%BE%D1%84%D0%BB%D0%B0%D0%B9%D0%BD-%D1%80%D0%B5%D0%B6%D0%B8%D0%BC-%D0%B8-%D1%81%D0%B8%D0%BD%D1%85%D1%80%D0%BE%D0%BD%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F).

### UI-REG-014 — Печатный экспорт
- **Фактическое состояние:** таблицы в `export_print.html` не выходят за границы, шрифты используют `font-heading` и `font-sans` без сбоев, цвета адаптированы к принтерному режиму.
- **Дополнительно:** проверено, что скрытые элементы (`.print:hidden`) корректно исключаются в режиме печати.
- **Итог:** шаблон готов к использованию без дополнительных правок.

## Рекомендации

- Перед каждым релизом повторять проверку чек-листа (см. [docs/checklists/ui-regression-checklist.md](../checklists/ui-regression-checklist.md)).
- При обновлении дизайн-токенов обязательно синхронизировать `tailwind.src.css` и `tailwind.min.css`, иначе стиль в DEV/PROD будет расходиться.
- Сохранять скриншоты локально с датой и идентификатором кейса; бинарные файлы не добавляются в репозиторий.
